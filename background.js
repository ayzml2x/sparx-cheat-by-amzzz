const r=(o,e)=>o instanceof e?o:new e,t=(o,e)=>{chrome.tabs.captureVisibleTab(c=>{chrome.storage.local.get("screenshotURLs",n=>{const s=r(n.screenshotURLs,Object);s[o]??(s[o]={}),s[o][e]=c,chrome.storage.local.set({screenshotURLs:s})})})};chrome.runtime.onMessage.addListener((o,e,c)=>{o.action==="takeScreenshot"?(t(o.packageId,o.bookworkCode),c()):o.action==="setHomeworkInfos"?chrome.storage.local.get("homeworkInfos",n=>{let s=r(n.homeworkInfos,Object);s[o.packageId]=o.homeworkInfo,chrome.storage.local.set({homeworkInfos:s})}):o.action==="openURL"&&chrome.tabs.create({url:o.url})});chrome.tabs.onUpdated.addListener((o,e)=>{if(e.url){const c=e.url.split("/");c.includes("wac")?chrome.tabs.sendMessage(o,{action:"showBookworkAnswer"}):c.includes("summary")&&chrome.tabs.sendMessage(o,{action:"clickNextTask"})}});
